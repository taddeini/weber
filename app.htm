<!DOCTYPE html>
<html>
    <head>
        <title>RSS Client</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="css/main.css">
        <script type="text/javascript" src="scripts/libs/modernizr-2.5.3.min.js"> </script>
    </head>
    <body>
        <section id="main"></section>

        <script type="text/javascript" src="scripts/libs/jquery-1.7.1.min.js"> </script>
        <script type="text/javascript" src="scripts/libs/underscore.min.js"> </script>
        <script type="text/javascript" src="scripts/libs/moment.min.js"> </script>
        <script type="text/javascript" src="scripts/libs/backbone-min.js"></script>
        
        <script type="text/javascript" src="scripts/utils.js"> </script>
        <script type="text/javascript" src="scripts/weber.js"> </script>
        <script type="text/javascript" src="scripts/models/post.js"> </script>
        
        <script type="text/template" id="postTemplate">
            <article>
                <header>   
                    <h1><%= title%></h1>
                    <p class="byline">Posted on <time datetime="<%= publishedDateMeta%>"><%= publishedDateDisplay%> CDT</time> by <%= author%></p>
                </header>
                <%= content%>
            </article>   
        </script>

        <script type="text/javascript">
            
            (function (global) {
                global.Weber = Weber = {};

                var helpers = utils(moment, $);

                Backbone.Model.prototype.helpers = helpers;
                Backbone.Collection.prototype.helpers = helpers;
            
                Weber.Feed = Backbone.Collection.extend({
                    initialize: function (feedUrl, callbacks) {
                        var that = this;
                        
                        this.helpers.ajax.getFeed(feedUrl, function (feed) {
                            that.models = feed;
                            _.each(callbacks, function (callback) { callback(that); });
                        });
                    },

                    model: Weber.Post
                });

            }(this));

            $(function () {
                new Weber.Feed("http://feeds.encosia.com/Encosia", [
                    function (feed) {
                        var post = new Weber.Post(feed.models.entries[0]);
                        var postView = new Weber.PostView({ model: post });
                        postView.render();
                    }]
                );
            }); 
        </script>
        
        
    </body>
</html>