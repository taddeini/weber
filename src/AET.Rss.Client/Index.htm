<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>RSS Client</title>
        <meta name="description" content="">

        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="Styles/Main.css">

        <script type="text/javascript" src="Scripts/Lib/modernizr-2.5.3.min.js"></script>
    </head>
    <body>
        <section id="main"></section>

        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"> </script>
        <script type="text/javascript" src="Scripts/Lib/jquery.tmpl.min.js"> </script>
        
        <script type="text/javascript">
            // TODO: Load should be pushed back as part of either Core or Services
            var load = (function() {
                return {
                    feed: function(url, callback) {
                        $.ajax({
                            url: document.location.protocol + 
                                "//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q=" + 
                                encodeURIComponent(url),
                            dataType: "json",
                            success: function(data) {
                                callback(data.responseData.feed);
                            }
                        });
                    }
                };
            }());

            // TODO: Render should be pushed back as part of either Core or Services
            var render = (function() {
                return {
                    post: function(post) {
                        //TODO: Cache the compiled template here
                        $("#postTemplate").tmpl(post).appendTo("#main");
                    }
                };
            }());

            var feed = load.feed("http://www.bettycrocker.com/community/rss.aspx?blogId=jillblog&Mode=0&WT.mc_id=rss_JillBlog_XML", function(feed) {
                var postData = new post(feed.entries[3]);
                render.post(postData);
            });

            //TODO: Hey, a nice little object here that needs to be tested
            var post = function(raw) {
                //TODO: Format date display items here
                return raw;
            };
            
        </script>
        
        <script type="text/x-jquery-tmpl" id="postTemplate">
            <article>
                <header>   
                    <h1>${title}</h1>
                    <p class="byline">Posted on <time datetime="2012-03-29T23:31:45+01:00">${publishedDate}</time> by ${author}</p>
                </header>
                {{html content}}
            </article>   
        </script>
    </body>
</html>